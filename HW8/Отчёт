# –û—Ç—á—ë—Ç –ø–æ –∑–∞–¥–∞–Ω–∏—é HW8 üîç

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å —Ä–∞–±–æ—Ç—É Scapy, —Å–æ–±—Ä–∞—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å HTTP-—Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å —É—á–µ–±–Ω—ã–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º Google Gruyere, –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ XSS –∏ –æ—Ñ–æ—Ä–º–∏—Ç—å –æ—Ç—á—ë—Ç —Å –≤—ã–≤–æ–¥–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.

> –í–∞–∂–Ω–æ: –≤ –æ—Ç—á—ë—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ, —É—á–µ–±–Ω—ã–µ –∏ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å–ª–µ–¥—É–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π —Å—Ä–µ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Google Gruyere ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —É—è–∑–≤–∏–º–∞—è –ø–ª–æ—â–∞–¥–∫–∞) –∏ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª —ç—Ç–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## 1. –°—Ä–µ–¥–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ üîß
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Scapy (Python), –±—Ä–∞—É–∑–µ—Ä —Å DevTools (Network), Wireshark (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ PCAP.
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Scapy: `pip install scapy` (–≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
- –ó–∞–ø—É—Å–∫ Gruyere: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é Google Gruyere (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π —Ö–æ—Å—Ç) ‚Äî —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å —É—á–µ–±–Ω–æ–π –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–µ–π.

## 2. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Å–±–æ—Ä–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ üõ∞Ô∏è
1. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ): –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Network Tab –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ HTTP/HTTPS-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤. –≠—Ç–æ —Å–∞–º—ã–π —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–µ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞.
2. Scapy (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä): –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å HTTP-—Ç—Ä–∞—Ñ–∏–∫. –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–Ω–∏—Ñ—Ñ–µ—Ä–∞ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤):

```python
from scapy.all import sniff, TCP, Raw

def http_packet(pkt):
    if pkt.haslayer(TCP) and pkt.haslayer(Raw):
        payload = pkt[Raw].load
        try:
            text = payload.decode('utf-8', errors='ignore')
        except Exception:
            return
        if text.startswith('GET') or text.startswith('POST') or 'HTTP/' in text:
            print('\n--- HTTP Packet ---')
            print(text[:1000])  # –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞—á–∞–ª–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

sniff(filter='tcp port 80', prn=http_packet, store=False, count=0)
```

- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–π –∫–æ–¥ —Å–ª—É–∂–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–±–æ—Ä–∞ —Ç—Ä–∞—Ñ–∏–∫–∞; –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å HTTPS —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ –∏ –≤ Scapy –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è —É–≤–∏–¥–µ—Ç—å —Ç–µ–ª–æ –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (—á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π, –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ).

## 3. –ö–∞–∫ XSS –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ç—Ä–∞—Ñ–∏–∫–µ –∏ —á—Ç–æ –∏—Å–∫–∞—Ç—å üîé
- –î–ª—è –æ—Ç—Ä–∞–∂—ë–Ω–Ω–æ–≥–æ (reflected) XSS: –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (payload) –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–ø—Ä–æ—Å–∞ (GET/POST) –∏ –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ç–µ–ª–µ HTML-–æ—Ç–≤–µ—Ç–∞ –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —ç–∫—Ä–∞–Ω–∏–∑–∞—Ü–∏–∏.
- –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–æ–≥–æ (stored) XSS: payload —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –±–∞–∑–µ) –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –≤ —Ç–µ–ª–µ –æ—Ç–≤–µ—Ç–∞.
- –ö–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ç—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (query string, POST body)
  - –ü–æ–ª–µ `Content-Type` –æ—Ç–≤–µ—Ç–∞
  - –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ (–ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ `<script>` –∏–ª–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ —Å–æ–±—ã—Ç–∏–π `onerror`, `onclick` –∏ —Ç.–¥.)
  - –ö—É–∫–∏ –∏ –∏—Ö —Ñ–ª–∞–≥–∏ (`HttpOnly`, `Secure`)

## 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ XSS (—ç—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏) ‚ö†Ô∏è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∏–ª–∏ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ç–µ–Ω–¥–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, Google Gruyere).
- –ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ payload‚Äô—ã –∏ –Ω–µ –∞—Ç–∞–∫–æ–≤–∞—Ç—å —Ç—Ä–µ—Ç—å–∏ —Å—Ç–æ—Ä–æ–Ω—ã.
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —à–∞–≥: —Ç–æ—á–Ω—ã–π URL, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∑–∞–≥–æ–ª–æ–≤–∫–∏, –≤—Ä–µ–º—è, –æ–∂–∏–¥–∞–µ–º—ã–π –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç. –î–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å PCAP-—Ñ–∞–π–ª—ã –¥–ª—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –±–∞–∑—ã.

## 5. –ü—Ä–∏–º–µ—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π (–æ–±–æ–±—â—ë–Ω–Ω–æ, –±–µ–∑ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π) üìã
- –ù–∞–±–ª—é–¥–µ–Ω–∏–µ: –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `q` –≤ URL —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `q` –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî —ç—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ XSS.
- –ö–∞–∫ —ç—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ç—Ä–∞—Ñ–∏–∫–µ: –≤ HTTP-–∑–∞–ø—Ä–æ—Å–µ –≤–∏–¥–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `q=...payload...`, –≤ HTTP-–æ—Ç–≤–µ—Ç–µ ‚Äî HTML, –≥–¥–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Ç–∞ –∂–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤.

## 6. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π ‚úÖ
1. –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (HTML-encoding) –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –≤ HTML.
2. –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `escape` –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö).
3. –í–Ω–µ–¥—Ä–∏—Ç—å Content Security Policy (CSP) –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ JS.
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `HttpOnly` –∏ `Secure` —Ñ–ª–∞–≥–∏ –¥–ª—è cookies, –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –Ω–∏—Ö.
5. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤–≤–æ–¥ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞, –Ω–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é.

## 7. –®–∞–±–ª–æ–Ω –∑–∞–ø–∏—Å–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–π —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (–¥–ª—è –æ—Ç—á—ë—Ç–∞) üìù
- ID: HW8-XSS-01
- URL: (—É–∫–∞–∑–∞—Ç—å)
- –ú–µ—Ç–æ–¥: GET/POST
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: (–ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å)
- –û–ø–∏—Å–∞–Ω–∏–µ: (–∫—Ä–∞—Ç–∫–æ ‚Äî –≥–¥–µ –∏ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è)
- –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: (–Ω–∏–∑–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/–≤—ã—Å–æ–∫–∏–π)
- –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞: (—Å–∫—Ä–∏–Ω—à–æ—Ç—ã/PCAP/—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞)
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à–∞–≥–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–û—Ç—á—ë—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö. –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, –º–æ–≥—É:
- –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —à–∞–≥–∞–º (–µ—Å–ª–∏ –≤—ã –ø—Ä–æ–≤–µ–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ –ø—Ä–∏—à–ª—ë—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã/PCAP/–ª–æ–≥–∏), ‚úÖ
- –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π Jupyter Notebook –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ –∏ –∏—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, ‚öôÔ∏è
- –ø–æ–º–æ—á—å –æ—Ñ–æ—Ä–º–∏—Ç—å –æ—Ç—á—ë—Ç –≤ PDF/Markdown —Å –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏ –≤—ã–≤–æ–¥–æ–≤. üìÑ

–ï—Å–ª–∏ —Å–æ–≥–ª–∞—Å–Ω—ã, –∑–∞–ø–∏—Å—ã–≤–∞—é —Ñ–∞–π–ª –æ—Ç—á—ë—Ç–∞ –ø—Ä—è–º–æ –≤ `HW8/–û—Ç—á—ë—Ç` –∏ –º–æ–≥—É –¥–æ–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (PCAP/—Å–∫—Ä–∏–Ω—à–æ—Ç—ã) –ø–æ –º–µ—Ä–µ –Ω–∞–ª–∏—á–∏—è.
