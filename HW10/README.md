## Описание уязвимости:
CVE-2024-6387 (RegreSSHion) — критическая уязвимость в OpenSSH-сервере (sshd), вызванная состоянием гонки (race condition) в обработчике сигналов. Если клиент не проходит аутентификацию в течение установленного времени (LoginGraceTime), срабатывает обработчик сигнала SIGALRM, который вызывает небезопасные функции (например, syslog()). Это позволяет неавторизованному удаленному атакующему выполнить произвольный код с привилегиями root на системах Linux с библиотекой glibc .

## Минимальный PoC-скрипт (имитация):
Этот скрипт эмулирует поведение эксплойта для CVE-2024-6387. Он подключается к SSH-серверу, намеренно не проходит аутентификацию, чтобы вызвать срабатывание таймера (LoginGraceTime), и имитирует попытку эксплуатации состояния гонки путем многопоточной отправки мусорных данных.

```shell
$ python3 CVE-2024-6387_poc.py 192.168.1.100
[*] Цель: 192.168.1.100:22
[*] Эмуляция CVE-2024-6387 (RegreSSHion)...
[!] Это имитация, реальная эксплуатация не производится.

[+] Баннер сервера: SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.6
[*] Имитация бездействия клиента (ожидание LoginGraceTime)...

[*] Эмуляция состояния гонки (Race Condition) через множественные подключения...
    [Поток-0] Запрос отправлен.
    [Поток-1] Запрос отправлен.
    ...

[!] Имитация атаки завершена.
[+] Потенциально уязвимая цель: В реальных условиях могла бы быть предпринята попытка RCE.
```

## Пояснение работы скрипта
# Обнаружение: 
Скрипт подключается к указанному хосту и порту (по умолчанию 22), получает баннер SSH для определения версии сервера. Уязвимыми считаются версии OpenSSH с 8.5p1 по 9.7p1 на Linux-системах с glibc .

# Эмуляция таймаута:
Согласно принципу работы CVE-2024-6387, атакующий должен не проходить аутентификацию в течение LoginGraceTime (обычно 120 секунд). В скрипте этот этап имитируется паузой в 5 секунд (для демонстрации), после чего соединение принудительно закрывается .

# Имитация Race Condition: 
В реальной атаке для повышения шансов на успех требуется множество попыток синхронизировать состояние гонки. Скрипт запускает несколько потоков, каждый из которых быстро подключается к серверу и отправляет мусорные данные, имитируя "шум", необходимый для создания условий гонки .